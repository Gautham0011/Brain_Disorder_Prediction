# -*- coding: utf-8 -*-
"""insomniapp.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Re381TUkyetRqjNYDGtIphdfAU9-DgaA
"""

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import pickle

test=pd.read_csv("insomniaa test.csv",error_bad_lines=False)
train=pd.read_csv("insomnia train.csv",error_bad_lines=False)

test.head()
train.head()
train.info()

train.head()

y_test = test.insomnia
x_test = test.drop('insomnia',axis = 1)
y_train = train.insomnia
x_train = train.drop('insomnia', axis = 1)

from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

clf_rf = RandomForestClassifier(random_state=43)      
clr_rf = clf_rf.fit(x_train,y_train)

ac = accuracy_score(y_test,clf_rf.predict(x_test))
print('Accuracy is: ',ac)

pickle.dump(clr_rf,open('model.pkl','wb'))

col=x_train.columns

type(col)
len(col)

inputt = "alcohol coffee stress".split(' ')
inputt

b=[0]*len(col)
for x in range(0,4):
    for y in inputt:
        if(col[x]==y):
            b[x]=1
b=np.array(b)
b=b.reshape(1,4)
sol=clf_rf.predict(b)
sol